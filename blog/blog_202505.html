<!DOCTYPE html>
<html>
    <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
    * {
    box-sizing: border-box;
    }

    /* Add a gray background color with some padding */
    body {
    font-family: Arial;
    padding: 20px;
    background: #f1f1f1;
    }

    /* Header/Blog Title */
    .header {
    padding: 30px;
    font-size: 40px;
    text-align: center;
    background: white;
    }

    /* Create two unequal columns that floats next to each other */
    /* Left column */
    .leftcolumn {   
    float: left;
    width: 85%;
    }

    /* Right column */
    .rightcolumn {
    float: left;
    width: 15%;
    padding-left: 20px;
    }

    /* Fake image */
    .fakeimg {
    background-color: #aaa;
    width: 100%;
    padding: 20px;
    }

    /* Add a card effect for articles */
    .card {
    background-color: white;
    padding: 20px;
    margin-top: 20px;
    }

    /* Clear floats after the columns */
    .row:after {
    content: "";
    display: table;
    clear: both;
    }

    /* Footer */
    .footer {
    padding: 20px;
    text-align: center;
    background: #ddd;
    margin-top: 20px;
    }

    /* Responsive layout - when the screen is less than 800px wide, make the two columns stack on top of each other instead of next to each other */
    @media screen and (max-width: 800px) {
    .leftcolumn, .rightcolumn {   
        width: 100%;
        padding: 0;
    }
    }
    </style>
    </head>

    <body>

        <div class="header">
        <h2>Stocksy's Cloud Blog</h2>
        <h4>May 2025</h4>
        </div>

        <div class="row">
            <div class="leftcolumn">
                <div class="card">

                    <h2>StocksCloud Website is Live &#128640</h2>

                    <p>
                        Welcome to my blog!
                    </p>

                    <h4>Requirements &#128466</h4>
                    <p>
                        Given the requirements in <a href="https://cloudresumechallenge.dev/docs/the-challenge/aws/" target="_blank">The Cloud Resume Challenge - AWS</a>, the StocksCloud website was built with several architecture principles in mind based on my interpretation of the design spec while considering the six pillars of the <a href="https://aws.amazon.com/architecture/well-architected/?wa-lens-whitepapers.sort-by=item.additionalFields.sortDate&wa-lens-whitepapers.sort-order=desc&wa-guidance-whitepapers.sort-by=item.additionalFields.sortDate&wa-guidance-whitepapers.sort-order=desc" target="_blank">AWS Well-Architected Framework</a>.
                        I used the MOSCOW method (MUST, SHOULD, COULD, WONT) as described below. Although all requirements might be judged initially to be MUST, where appropriate I used tooling which allows for some improvements versus the original design spec.

                        <ol type="1">
                            <li>MUST implement Security best practices: I've used principle of least privilege for all IAM users and policies. Data is encrypted in transit (HTTPS with TLSv1.3) and data is encrypted at rest (DynamoDB table objects using DynamoDB-owned KMS key, S3 bucket objects using SSE-S3). I've added a bucket policy which only allows a CloudFront Distribution endpoint to access the S3 origin using Origin Access Control.</li>
                            <li>MUST utilise Cost Optimization and Performance Efficiency: A Serverless architecture with on-demand (pay-per-use) DynamoDB table, API Gateway fronting a Lambda function which updates the site hit counter instead of long-running EC2 instances or a Container platform for compute. Lambda is always free up to 1 million invocations per month :)</li>
                            <li>MUST apply Operational Excellence: Using DevOps automation and event-driven architectures, the website's backend and frontend is deployed through GitHub Actions upon git push to the Main repo branch. Monitoring for failed GitHub pipelines and CloudWatch monitoring are both available out-of-the-box, further improving operational responsiveness.</li>
                            <li>MUST perform Reliably: By leveraging AWS-managed services, the site is highly available within a single region, easily achieving enough reliability for my static website use case.</li>
                            <li>MUST consider Sustainability: Employing a Serverless architecture ensures that workloads only run for as long as necessary. Using CDK templates and CloudFormation stacks means that infrastructure is declarative and can be quickly disposed of when no longer required.</li>
                            <li>SHOULD use CI/CD, HTML, CSS and a JavaScript website hit counter for the frontend and store code in source control: I hand-crafted much of the HTML but found that I couldn't write a JavaScript hitcounter function! Here, I leant on <a href="//claude.ai/" target="_blank">Claude AI</a> to assist me with writing the JavaScript function to interface with a REST API Gateway endpoint. The API invokes a Python 3.9 Lambda function to increment the page hit count. The hit count is persisted in a DynamoDB table. CSS is used to style the HTML body elements of each page.</li>
                            <li>SHOULD use an API, Python (including Tests), a Database and CI/CD for the backend: I utilised GitHub Actions, enabling the backend components to be created as a single CloudFormation stack using <i>cdk deploy</i> within the GitHub Actions workflow. The CDK template was written in TypeScript; coding was again ably assisted by Claude AI who wrote much of the template.</li>
                            <li>COULD use SAM (Serverless Application Model) templates to define the backend infrastructure and store code in source control: Here I deviated from the design spec by opting to use CDK (Cloud Development Kit), a well-supported AWS framework for defining infrastructure-as-code in a number of popular languages. I opted for TypeScript due to its support by AWS and usage within my own business environments, allowing me to upskill in CDK. I covered the CI/CD requirements by implementing GitHub Actions workflows for both the frontend (website) and backend (infrastructure) repos and set the workflows to run upon a git push to the Main branch.</li>
                            <li>COULD write a blog post about my experience. I did!</li>
                        </ol>
                    </p>

                    <h4>Architecture &#x1F3D7</h4>

                    <p>
                        <i>Fig 1: Architecture Diagram</i>

                        <p>The diagram shows the CDK Infrastructure repo (GitHub name: cloud_resume_challenge_python_backend) and the Website repo (GitHub name: cloud_resume_challenge_website) interacting with AWS using GitHub Actions workflows (one workflow per repo) and an AWS IAM User containing an attached Inline Policy.</p>
                        <p>Clients (Users) are shown accessing the website via Route 53 (DNS) and CloudFront (Content Delivery Network).</p>
                        <p>The GitHub Actions workflows are triggered via a 'git push' to the main branch of each repo. They can also be triggered manually from the GitHub Actions UI (useful for troubleshooting failed workflows).</p>
                    </p>

                    <p>
                        <object
                            data="../assets/website_architecture.pdf"
                            type="application/pdf"
                            width="100%"
                            height="1000"
                            style="border: none"
                            title="Website Architecture PDF"
                        >
                            <iframe
                                src="../assets/website_architecture.pdf"
                                width="100%"
                                height="100%"
                                style="border: none"
                                title="Fallback PDF Viewer"
                            >
                                <p>
                                    Your browser does not support PDFs.
                                    [<a href="../assets/website_architecture.pdf" target="_blank">Download the PDF</a>]
                                </p>
                            </iframe>
                        </object>
                    </p>

                    <h4>Future Improvements &#x1F4C8</h4>
                    <p>
                        While good security practices have been followed, the implementation of this website includes some IAM issues which can be addressed. Encrypted secrets used by GitHub Actions are placed into environment variables and work in concert with least-privileged AWS users/policies to perform tasks such as updating the CloudFormation stack, file PUT requests to S3, or CloudFront cache invalidations. These use long-lived access keys, which although encrypted is not advisable due to the potential for a credentials leak. Most companies recommend moving away from using these access methods.
                        AWS highly recommend implementing IAM Roles to issue STS (Security Token Service) calls such as <i>sts:AssumeRoleWithWebIdentity</i>, which provides temporary AWS access credentials by issuing the requestor with a short-lived Security Token. The time-limited nature of security tokens makes them by definition more secure than using long-lived credentials. I aim to create Roles and integrate them with my GitHub Actions as the main future website enhancement.
                    </p>

                    <h4>Final Thoughts &#x1F914</h4>
                    <p>
                        You might be thinking "It's a static website, you could have hosted it in S3!" Yes I <i>could</i>, however there is justification for taking my approach:

                        <ul>
                            <li>Principally, I would have failed to meet the design spec of the Cloud Resume Challenge; reason enough to steer away from the S3 web hosting solution.</li>
                            <li>The site is HTTPS because it has a Route 53 hosted zone including an ACM (AWS Certificate Manager) certificate issued by the Amazon CA. This is more secure than a plain HTTP site hosted from an S3 bucket (or indeed anywhere which does not offer HTTPS).</li>
                            <li>The inclusion of a CloudFront Distribution provides the advantage of a CDN (edge and regional edge caches) to serve the site pages and static assets. This makes site content available to a global user base with decreased latency & jitter, regardless of which geography/region the user is located. Direct S3 bucket access cannot offer a globally-distributed caching layer. As mentioned in the Requirements section, <b>only</b> the Distribution can access the S3 origin, strengthening the security posture of the site. Due to the globally-distributed CloudFront CDN edge locations, some mitigation benefits against DDoS attacks may also be realised. When running production workloads, WAF and Shield Advanced should also be implemented for improved web and DDoS protection. This is beyond the scope of running a small-scale development website.</li>
                            <li>Finally, in the S3 bucket properties, AWS recommend using <a href="https://aws.amazon.com/amplify/faqs/?trk=bde46bbc-b618-48e1-b86a-1dd4c35b930f&sc_channel=ps&ef_id=EAIaIQobChMIyuLR26TLjQMV15VQBh3RlxEGEAAYASABEgJ19vD_BwE:G:s&s_kwcid=AL!4422!3!647301968149!e!!g!!aws%20amplify!19621293721!146139123512&gad_campaignid=19621293721&gbraid=0AAAAADjHtp-McekRy0of67TMEVkfAd3-w&gclid=EAIaIQobChMIyuLR26TLjQMV15VQBh3RlxEGEAAYASABEgJ19vD_BwE" target="_blank">Amplify</a> for static web hosting instead of using S3.</li>
                        </ul>
                    </p>
                    <p>
                        Thank you for reading!
                    </p>
                </div>

            </div>
            <div class="rightcolumn">
                <div class="card">
                    <h3>Other Blogs</h3>
                    <p>
                        <a href="/blog/blog_202507.html">July 2025</a>
                    </p>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <h2>
                <a href="../">Home</a>
            </h2>
        </div>

        <!-- Hit counter, written by Claude AI -->
        <div id="hitCounter">Hit Counter: Loading...</div>
        
        <script>
            document.addEventListener('DOMContentLoaded', () => {
                try {
                    const counter = document.getElementById('hitCounter');
                    if (!counter) return; // Exit if element not found
                    
                    // Get the page path to use as a unique identifier
                    const pagePath = window.location.pathname;

                    // API_ENDPOINT env var will be replaced during build time
                    const apiEndpoint = '%%API_ENDPOINT%%/incrementCounter';

                    // Call the API Gateway endpoint to increment the counter
                    fetch(apiEndpoint, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ pagePath: pagePath })
                    })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        // Update the counter with the value from the DB
                        counter.textContent = 'Hit Counter: ' + data.count;
                    })
                    .catch(error => {
                        console.error('Error updating hit counter:', error);
                        counter.textContent = 'Hit Counter: Error';
                    });
                } catch (error) {
                    console.log('Hit counter error:', error);
                }
            });
        </script>

    </body>
</html>
