import"./modulepreload-polyfill-3cfb730f.js";/* empty css              */function r(){const e=new URL(window.location.href).searchParams.get("id");e?(console.debug("VA: Dynamically adding MiroSDK .. "),i(()=>{console.debug("VA: In Callback post SDK attachment .."),console.debug("VA: Calling Init AppFlow .."),c(e)})):console.debug("VA: Assessment ID not found - App will not render ..")}function i(n){console.debug("VA: Attempting to dynamically add the Miro SDK ..");const e="V2";console.debug("VA: Miro SDK version to load: "+e);let t,o=document.createElement("script");switch(e){case"V1":{t="https://miro.com/app/static/sdk.1.1.js";break}case"V2":{t="https://miro.com/app/static/sdk/v2/miro.js";break}default:{t="https://miro.com/app/static/sdk.1.1.js";break}}o.setAttribute("src",t),o.onload=n,document.body.appendChild(o)}async function c(n){const e="V2";if(l(n)){console.debug("VA: Cookie found - App will not render until it expires or is removed via clearing cookies .. ");return}else{console.debug("VA: Cookie not found - attempting to launch App Modal .. ");try{if(e!=="V1"){if(e==="V2"){console.debug("VA: V2 - Getting User .. ");const o=(await miro.board.getUserInfo()).id;console.log(o),d(n,o)}}}catch{console.debug("VA: Failed to fetch Miro User .. App will not render")}}}function l(n){return a(n)!=""?(console.debug("VA: Defer Cookie Found. Dismissing.."),!0):(console.debug("VA: No Cookie Found. Continuing.."),!1)}function a(n){let e=n+"=",t=document.cookie.split(";");for(let o=0;o<t.length;o++){let s=t[o];for(;s.charAt(0)==" ";)s=s.substring(1);if(s.indexOf(e)==0)return s.substring(e.length,s.length)}return""}async function d(n,e){const t="https://api.mirohostedsolutions.com";console.debug(t);try{const[o]=await Promise.all([fetch(`${t}/v1/assessment/${n}/responses/user/${e}`,{mode:"cors",method:"GET",headers:{"Content-Type":"application/json"}})]);o.status===200?console.debug("VA: User has already responded. Dismissing.."):o.status!==200?await u(n,e):(console.error("VA: Start Received an unexpected response from backend.."),console.error(o.status),console.error("VA: End Received an unexpected response from backend.."))}catch(o){console.error("VA: Error in fetching assessment data.."),console.error("VA: Start error block.."),console.error(o),console.error("VA: End error block..")}}async function u(n,e){console.debug("VA: Attempting to launch Modal for Assessment"),console.debug("VA: Launching V2 Modal .. "),miro.board.ui.openModal({url:`/app.html?assessment_id=${n}&user_id=${e}`,height:600,width:1e3}).then(()=>{console.debug("VA: Modal force closed by user."),console.debug("VA: Modal will re-trigger on next subsequent board activity.")},()=>{console.error("VA: Miro Modal unexpected exit.."),console.error("VA: Start error block.."),console.error("VA: Promise not fulfilled"),console.error("VA: End error block..")})}document.addEventListener("DOMContentLoaded",r);
